description: "A shell deploy command to be executed with AWS credentials on the aws executor"

executor: aws

parameters:
  cmd:
    type: string
    description: "The shell command to run"
  aws_profile:
    type: string
    description: "The AWS profile to be used"
    default: "default"
  region:
    type: string
    description: "The aws region for the deployment"
    default: eu-west-1

environment:
  AWS_PROFILE: << parameters.aws_profile >>
  AWS_DEFAULT_REGION: << parameters.region >>

steps:
  - attach_workspace:
      at: ~/

  - run_aws:
      title: AWS deploy command - << parameters.cmd >>
      deploy: true
      cmd: << parameters.cmd >>
